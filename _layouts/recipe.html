---
layout: default
---

<script>
  window.RECIPE_DATA = {
    id: "{{ page.url | relative_url }}",
    title: {{ page.title | jsonify }},
    baseServings: {{ page.servings | default: 1 | jsonify }},
    ingredients: {{ page.ingredients | jsonify }}
  };
</script>

<div class="section">
  <div class="card cardPad">
    <div class="recipeHeader">
      <div class="h1" style="margin:0">{{ page.title }}</div>

      {% if page.image %}
        <div class="recipeHero">
          <img
            class="recipeHeroImg"
            src="{{ page.image | relative_url }}"
            alt="{{ page.title | escape }}"
            loading="lazy"
            decoding="async"
            style="width:100%;max-height:240px;object-fit:cover;display:block;"
          >
        </div>
      {% endif %}

      <div class="kvRow">
        {% if page.category %}<span class="kv">ğŸ· {{ page.category }}</span>{% endif %}
        {% if page.time %}<span class="kv">â± {{ page.time }}</span>{% endif %}
        {% if page.servings %}<span class="kv">ğŸ½ {{ page.servings }}</span>{% endif %}
        {% if page.date %}<span class="kv">ğŸ“… {{ page.date | date: "%d.%m.%Y" }}</span>{% endif %}
        <span class="kv kvFav" id="favPill" hidden>â˜… Favorit</span>
      </div>

      {% if page.tags %}
      <div class="chips">
        {% for t in page.tags %}
          <span class="chip">{{ t }}</span>
        {% endfor %}
      </div>
      {% endif %}
    </div>

    <div class="hr"></div>

    <div class="dim" id="statsLine"></div>

    <div class="hr"></div>

    <div class="card cardPad recipeInnerCard" style="box-shadow:none;border:1px solid rgba(15,23,42,.10)">
      <div class="searchRow" style="padding:0">
        <div style="flex:1">
          <div class="sub" style="margin-bottom:6px">Portionen</div>
          <input id="servingsInput" inputmode="numeric" style="width:100%" />
          <div class="dim" style="margin-top:6px">Basis: <span id="baseServings"></span></div>
        </div>
      </div>

      <div class="hr"></div>

      <div class="h2" style="margin:0 0 8px 0">Zutaten</div>
      <div class="listGroup" id="ingredientsGroup">
        <div id="ingredientsList"></div>
      </div>
    </div>

    <div class="hr"></div>

    <div class="recipeBody">
      {{ content }}
    </div>
  </div>
</div>

<!-- Sticky Bottom Action Bar -->
<nav class="tabbar bottomRail recipeTabbar" aria-label="Rezept Aktionen">
  <div class="tabbarInner container">
    <button class="tabItem pressable" id="cookingModeQuick" type="button">
      <span class="tabIcon">ğŸ³</span><span class="tabLabel">Kochmodus</span>
    </button>

    <button class="tabItem pressable active" id="addToShopping" type="button">
      <span class="tabIcon">ğŸ›’</span><span class="tabLabel">Zur Liste</span>
    </button>

    <button class="tabItem pressable" id="freezerQuick" type="button">
      <span class="tabIcon">ğŸ§Š</span><span class="tabLabel">KÃ¼hltruhe</span>
    </button>

    <button class="tabItem pressable" id="recipeMoreBtn" type="button">
      <span class="tabIcon">â‹¯</span><span class="tabLabel">Mehr</span>
    </button>
  </div>
</nav>

<!-- Recipe More Sheet -->
<div class="sheetOverlay" id="recipeSheetOverlay"></div>
<section class="sheet" id="recipeSheet" aria-label="Rezept-MenÃ¼" aria-hidden="true">
  <div class="sheetGrab"></div>
  <div class="sheetHead">
    <div class="sheetTitle">Rezept</div>
    <button class="navIconBtn pressable" id="recipeSheetClose" aria-label="SchlieÃŸen" type="button">âœ•</button>
  </div>

  <div class="sheetBody">
    <div class="sheetSectionLabel">Schnellzugriff</div>
    <a class="sheetRow" href="{{ '/' | relative_url }}">âŒ‚ Start</a>
    <a class="sheetRow" href="{{ '/rezeptindex/' | relative_url }}">ğŸ² Rezepte</a>
    <a class="sheetRow" href="{{ '/shopping/' | relative_url }}">ğŸ›’ Shopping List</a>

    <div class="sheetSectionLabel">Aktionen</div>
    <button class="sheetRow" id="cookingModeBtn" type="button">ğŸ³ Kochmodus</button>
    <button class="sheetRow" id="sheetFavoriteBtn" type="button">â˜† Favorit</button>
    <button class="sheetRow" id="sheetCookedBtn" type="button">âœ… Gekocht</button>
    <button class="sheetRow" id="sheetFreezerBtn" type="button">ğŸ§Š KÃ¼hltruhe</button>
    <button class="sheetRow" id="undoCookedBtn" type="button">â†©ï¸ Undo â€Gekochtâ€œ</button>
    <button class="sheetRow" id="printBtn" type="button">ğŸ–¨ Drucken</button>
  </div>
</section>

<!-- Freezer Sheet (KÃ¼hltruhe) -->
<div class="sheetOverlay" id="freezerSheetOverlay"></div>
<section class="sheet" id="freezerSheet" aria-label="KÃ¼hltruhe" aria-hidden="true">
  <div class="sheetGrab"></div>
  <div class="sheetHead">
    <div class="sheetTitle">KÃ¼hltruhe</div>
    <button class="navIconBtn pressable" id="freezerSheetClose" aria-label="SchlieÃŸen" type="button">âœ•</button>
  </div>
  <div class="sheetBody">
    <div class="sheetRow" style="display:flex;gap:10px;align-items:center;justify-content:space-between">
      <div>
        <div class="sub" style="margin:0">Portionen</div>
        <div class="dim" style="margin-top:4px" id="freezerHint">Nicht in KÃ¼hltruhe</div>
      </div>
      <div class="qtyStepper" aria-label="Portionen Ã¤ndern">
        <button class="stepBtn" id="freezerMinus" type="button" aria-label="Minus">âˆ’</button>
        <div class="stepVal" id="freezerCount">0</div>
        <button class="stepBtn" id="freezerPlus" type="button" aria-label="Plus">+</button>
      </div>
    </div>
    <div class="sheetSep"></div>
    <button class="sheetRow" id="freezerRemove" type="button">ğŸ—‘ Entfernen</button>
  </div>
</section>

<!-- Cooking Mode Overlay -->
<div class="cookOverlay" id="cookOverlay" aria-hidden="true">
  <div class="cookTop">
    <button class="navIconBtn pressable" id="cookClose" type="button" aria-label="Kochmodus schlieÃŸen">âœ•</button>
    <div class="cookTitle" id="cookTitle">Kochmodus</div>
    <div class="cookPill" id="cookStepPill">1/1</div>
  </div>

  <div class="cookTabs" role="tablist" aria-label="Kochmodus Tabs">
    <button class="cookTab active" id="cookTabSteps" type="button" role="tab" aria-selected="true">Schritte</button>
    <button class="cookTab" id="cookTabIngs" type="button" role="tab" aria-selected="false">Zutaten</button>
  </div>

  <div class="cookBody" id="cookBody">
    <div class="cookPanel" id="cookPanelSteps" role="tabpanel">
      <div class="cookStep" id="cookStepText"></div>
      <div class="cookNav">
        <button class="cookNavBtn" id="cookPrev" type="button">â€¹ ZurÃ¼ck</button>
        <button class="cookNavBtn primary" id="cookNext" type="button">Weiter â€º</button>
      </div>
    </div>
    <div class="cookPanel" id="cookPanelIngs" role="tabpanel" hidden>
      <div class="cookIngs" id="cookIngredients"></div>
    </div>
  </div>
</div>

<script defer src="{{ '/assets/recipe.js' | relative_url }}?v={{ site.time | date: '%s' }}"></script>

<script>
(function(){
  // Recipe sheet
  const moreBtn = document.getElementById('recipeMoreBtn');
  const overlay = document.getElementById('recipeSheetOverlay');
  const sheet = document.getElementById('recipeSheet');
  const closeBtn = document.getElementById('recipeSheetClose');
  const printBtn = document.getElementById('printBtn');

  function openSheet(){ overlay.classList.add('open'); sheet.classList.add('open'); sheet.setAttribute('aria-hidden','false'); }
  function closeSheet(){ overlay.classList.remove('open'); sheet.classList.remove('open'); sheet.setAttribute('aria-hidden','true'); }

  // iOS-like detents: half + full
  function setDetent(mode){
    sheet.classList.toggle('half', mode === 'half');
    sheet.classList.toggle('full', mode === 'full');
  }

  moreBtn?.addEventListener('click', ()=>{ openSheet(); setDetent('half'); });
  overlay?.addEventListener('click', closeSheet);
  closeBtn?.addEventListener('click', closeSheet);
  printBtn?.addEventListener('click', ()=>{
    closeSheet();
    setTimeout(()=>window.print(), 50);
  });

  // Grabber toggles detents
  const grab = sheet?.querySelector('.sheetGrab');
  grab?.addEventListener('click', ()=>{
    if(!sheet.classList.contains('open')) return;
    setDetent(sheet.classList.contains('full') ? 'half' : 'full');
  });

  // Hide recipe bar on non-recipe pages (safety, if layout reused)
  // (On this layout it always exists, so no-op)
})();
</script>
